<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MPS.AppSocio.Views.Views.Perfil"
             xmlns:cv="clr-namespace:MPS.AppSocio.Views.CV"
             xmlns:vm="clr-namespace:MPS.Core.Lib.ViewModels.Socios"
             BackgroundColor="{StaticResource AlterColor}">
    <ContentPage.BindingContext>
        <vm:DetalleSocioViewModel x:Name="ViewModel"/>
    </ContentPage.BindingContext>
    <ContentPage.Content>
        <Grid RowDefinitions="Auto,Auto,*" ColumnDefinitions=".05*,*,.05*" HorizontalOptions="FillAndExpand" VerticalOptions="FillAndExpand" Padding="0,5">
            <StackLayout Grid.Column="1" HorizontalOptions="Fill" VerticalOptions="Fill">
                <StackLayout Padding="10">
                    <Frame CornerRadius="25" HeightRequest="50" WidthRequest="50" BackgroundColor="CornflowerBlue"
                           HorizontalOptions="Center" Padding="0" IsClippedToBounds="True">
                        <Image Source="{Binding DetallesSocio.IMAGEN}" HorizontalOptions="Center" VerticalOptions="Center" />
                    </Frame>
                </StackLayout>
                <Label Text="{Binding NombreCompleto}" TextColor="White" FontAttributes="Bold" HorizontalOptions="Center" HorizontalTextAlignment="Center"/>
                <StackLayout Orientation="Horizontal" HorizontalOptions="Center">
                    <Label Text="Online" FontSize="Small" TextColor="White"/>
                    <Image Source="" Aspect="AspectFit" HorizontalOptions="Center" VerticalOptions="Center"/>
                </StackLayout>
                <Frame IsClippedToBounds="True" Padding="5" CornerRadius="15" BackgroundColor="LightGray" HorizontalOptions="Center">
                    <Grid ColumnDefinitions="Auto,Auto">
                        <Image HorizontalOptions="Center" VerticalOptions="Center"/>
                        <Label Grid.Column="1" Text="{Binding Ranking}" FontSize="Small" TextColor="Black" HorizontalOptions="End"/>
                    </Grid>
                </Frame>
            </StackLayout>
            <Image Grid.Column="1" Source="cerrar.png" HorizontalOptions="EndAndExpand" VerticalOptions="Start" Margin="{OnPlatform Android='5', UWP='5', iOS='10,30,10,1'}">
                <Image.GestureRecognizers>
                    <TapGestureRecognizer Command="{Binding RegresarCommand}"/>
                </Image.GestureRecognizers>
            </Image>
            <Grid Grid.Column="1" Grid.Row="1" RowDefinitions="Auto,*,Auto" ColumnDefinitions=".05*,*,.05*" HorizontalOptions="FillAndExpand" VerticalOptions="FillAndExpand">
                <ScrollView Grid.Row="1" Grid.Column="1" HorizontalOptions="FillAndExpand" VerticalScrollBarVisibility="Never">
                    <Grid RowDefinitions="Auto,*,Auto,Auto" VerticalOptions="StartAndExpand">
                        <Label Text="Datos generales" FontSize="Medium" FontAttributes="Bold" TextColor="White"/>
                        <StackLayout Grid.Row="1">
                            <cv:EntryView Text="{Binding DetallesSocio.NO_CLIENTE, Mode=TwoWay}" Etiqueta="No. Socio" IsEnabled="False" IsEnableText="{OnPlatform UWP=False}" TextColor="Gray"/>
                            <cv:EntryView Text="{Binding DetallesSocio.NOMBRE, Mode=TwoWay}" Etiqueta="Nombre(s)" TextColor="{OnPlatform Android='White', iOS='#000', UWP='#000'}"/>
                            <cv:EntryView Text="{Binding DetallesSocio.APELLIDO_1, Mode=TwoWay}" Etiqueta="Apellido Paterno" TextColor="{OnPlatform Android='White', iOS='#000', UWP='#000'}"/>
                            <cv:EntryView Text="{Binding DetallesSocio.APELLIDO_2, Mode=TwoWay}" Etiqueta="Apellido Materno" TextColor="{OnPlatform Android='White', iOS='#000', UWP='#000'}"/>
                            <DatePicker Date="{Binding DetallesSocio.FECHA_NACIMIENTO, Mode=TwoWay}" FontSize="Body" TextColor="{OnPlatform Android='White', iOS='#000', UWP='#000'}"/>
                            <Label Text="Fecha de Nacimiento" TextColor="Gray" FontSize="Small"/>
                            <Picker ItemsSource="{Binding Sexos}" SelectedItem="{Binding SexoSelected, Mode=TwoWay, UpdateSourceEventName=PropertyChanged}" FontSize="Body" TextColor="{OnPlatform Android='White', iOS='#000', UWP='#000'}"/>
                            <Label Text="Sexo" TextColor="Gray" FontSize="Small"/>
                        </StackLayout>
                        <Label Grid.Row="2" Text="Contacto" FontSize="Medium" FontAttributes="Bold" TextColor="White"/>
                        <StackLayout Grid.Row="3">
                            <cv:EntryView Text="{Binding DetallesSocio.E_MAIL, Mode=TwoWay}" Etiqueta="Correo Elentrónico" IsEnabled="False" IsEnableText="{OnPlatform UWP=False}" TextColor="Gray"/>
                            <cv:EntryView Text="{Binding DetallesSocio.TEL_NUMERO, Mode=TwoWay}" Keyboard="Numeric" Etiqueta="Teléfono" TextColor="{OnPlatform Android='White', iOS='#000', UWP='#000'}"/>
                        </StackLayout>
                    </Grid>
                </ScrollView>
                <Grid Grid.Column="1" Grid.Row="2" ColumnDefinitions="*,*" HorizontalOptions="FillAndExpand">
                    <Button Grid.Column="1" VerticalOptions="Center" HorizontalOptions="End" TextColor="White" CornerRadius="10" BackgroundColor="IndianRed" FontSize="Small" Padding="10,0" Text="Guardar" Command="{Binding ActualizaInfoCommand}"/>
                    <Button VerticalOptions="Center" HorizontalOptions="Start" TextColor="White" CornerRadius="10" BackgroundColor="LightGray" FontSize="Small" Padding="10,0" Text="Cambiar contraseña" Command="{Binding ModalPasswordCommand}"/>
                </Grid>
            </Grid>
            
            <!--Modal actualizar password-->
            <Frame VerticalOptions="FillAndExpand" Grid.RowSpan="3" Grid.ColumnSpan="3" HorizontalOptions="FillAndExpand" BackgroundColor="Gray" Opacity=".5" IsVisible="{Binding ModalPassword}"/>
            <Grid Grid.RowSpan="3" Grid.Column="1" RowDefinitions=".3*,Auto,.3*" ColumnDefinitions=".1*,*,.1*" IsVisible="{Binding ModalPassword}">
                <Frame Grid.Column="1" Grid.Row="1" CornerRadius="10" HorizontalOptions="FillAndExpand" VerticalOptions="FillAndExpand" BackgroundColor="White" IsClippedToBounds="True">
                    <Grid RowDefinitions="Auto, *, Auto" Padding="5">
                        <Label Text="Cambiar contraseña" Margin="0,0,0,0" TextColor="{StaticResource AlterColor}" FontAttributes="Bold" FontSize="Medium"/>
                        <ScrollView Grid.Row="1">
                            <StackLayout>
                                <cv:EntryView Text="{Binding Password, Mode=TwoWay}" Etiqueta="Introduzca nueva contraseña" HorizontalOptions="FillAndExpand" IsPassword="True" TextColor="#000000"/>
                                <Label Text="{Binding MensajePassword}" TextColor="Red" FontSize="Micro"/>
                                <cv:EntryView Text="{Binding PasswordConfirm, Mode=TwoWay}" Etiqueta="Confirme nueva contraseña" HorizontalOptions="FillAndExpand" IsPassword="True" TextColor="#000000"/>
                                <Label Text="{Binding MensajePasswordConfirm}" TextColor="Red" FontSize="Micro"/>
                            </StackLayout>
                        </ScrollView>
                        <Grid Grid.Row="2" ColumnDefinitions="*,*" VerticalOptions="Center">
                            <Button VerticalOptions="Center" HorizontalOptions="Center" CornerRadius="10" BackgroundColor="LightGray" FontSize="Small" Padding="10,0" Text="Cancelar" Command="{Binding OcultarModalPaswwordCommand}"/>
                            <Button Grid.Column="1" VerticalOptions="Center" HorizontalOptions="Center" CornerRadius="10" BackgroundColor="IndianRed" FontSize="Small" Padding="10,0" Text="Guardar" IsEnabled="{Binding PasswordCorrect}" Command="{Binding ActualizarPasswordCommand}"/>
                        </Grid>
                    </Grid>
                </Frame>
            </Grid>

            <!--Modal Informativo-->
            <Frame Grid.ColumnSpan="3" BackgroundColor="Gray" Opacity="0.5" Grid.RowSpan="3" IsVisible="{Binding Modal}"/>
            <Frame Grid.Column="1" Grid.RowSpan="3" VerticalOptions="Center" HorizontalOptions="FillAndExpand" IsVisible="{Binding Modal}" BackgroundColor="White" CornerRadius="20">
                <Grid ColumnDefinitions=".05*, *,.05*" RowDefinitions="Auto, .6*">
                    <Label Grid.Column="1" Text="{Binding Mensaje, Mode=TwoWay}" TextColor="Gray" FontSize="{OnPlatform Android=Body, iOS=Small}" VerticalTextAlignment="Center" VerticalOptions="Center" HorizontalTextAlignment="Center" HorizontalOptions="CenterAndExpand"/>
                    <StackLayout  Grid.Row="1" Grid.Column="1">
                        <Button Margin="0,5,0,0" CornerRadius="{OnPlatform Android='20', iOS='20', UWP='10'}" HorizontalOptions="CenterAndExpand" Padding="{OnPlatform Android='25,15', iOS='25,10',UWP='10,0'}" FontAttributes="None" Text="Aceptar" Command="{Binding OcultarModalCommand}" TextColor="White" FontSize="{OnPlatform Android=Body, iOS=Small}"/>
                    </StackLayout>
                </Grid>
            </Frame>
        </Grid>        
    </ContentPage.Content>
</ContentPage>